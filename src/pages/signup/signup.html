<!--
  Generated template for the SignupPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-title>注册</ion-title>
  </ion-navbar>
</ion-header>
<ion-content padding>
  <form class="signup-container" [formGroup]="signupForm">
    <ion-list>
      <ion-item>
        <ion-label>学号/工号</ion-label>
        <ion-input type="number" name="userName" [(ngModel)]="user.userName" formControlName="userName" required
                   maxLength="11">
        </ion-input>
      </ion-item>
      <div *ngIf="userName.invalid && (userName.dirty || userName.touched)">
        <ion-item *ngIf="userName.errors.required" class="message">
          账号不能为空
        </ion-item>
        <ion-item *ngIf="userName.errors.maxlength" class="message">
          长度不能超过11位
        </ion-item>
      </div>
      <ion-item>
        <ion-label>密码</ion-label>
        <ion-input type="password" name="password" [(ngModel)]="user.password" formControlName="password"
                   required></ion-input>
      </ion-item>
      <div *ngIf="password.invalid && (password.dirty || password.touched)">
        <ion-item *ngIf="password.errors.required" class="message">
          密码不能为空
        </ion-item>
      </div>
      <ion-item>
        <ion-label>确认密码</ion-label>
        <ion-input type="password" name="repassword" formControlName="repassword" [(ngModel)]="user.repassword"
                   required></ion-input>
      </ion-item>
      <div *ngIf="user.repassword !== user.password && (repassword.dirty || repassword.touched)">
        <ion-item  class="message">
          两次密码不一致
        </ion-item>
      </div>

      <ion-item>
        <ion-label>姓名</ion-label>
        <ion-input type="text" name="name" formControlName="name" [(ngModel)]="user.name"
                   required></ion-input>
      </ion-item>
      <div *ngIf="name.invalid && (name.dirty || name.touched)">
        <ion-item *ngIf="name.errors.required" class="message">
          姓名不能为空
        </ion-item>
        <ion-item *ngIf="name.errors.maxlength" class="message">
          长度不能超过10位
        </ion-item>
      </div>

      <ion-item *ngIf="user.role == 1">
        <ion-label>学院</ion-label>
        <ion-select name="college" formControlName="college" [(ngModel)]="user.college">
          <ion-option value="大气科学学院" selected="true">大气科学学院</ion-option>
          <ion-option value="计算机与软件学院">计算机与软件学院</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="user.role == 1">
        <ion-label>职称</ion-label>
        <ion-select name="title" formControlName="title" [(ngModel)]="user.title">
          <ion-option value="教授" selected="true">教授</ion-option>
          <ion-option value="副教授">副教授</ion-option>
          <ion-option value="讲师">讲师</ion-option>
        </ion-select>
      </ion-item>


      <ion-item>
        <ion-label>性别</ion-label>
        <ion-select name="sex" formControlName="sex" [(ngModel)]="user.sex">
          <ion-option value="0" selected="true">男</ion-option>
          <ion-option value="1">女</ion-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label>角色</ion-label>
        <ion-select name="role" formControlName="role" [(ngModel)]="user.role">
          <ion-option value="0" selected="true">学生</ion-option>
          <ion-option value="1">教员</ion-option>
          <ion-option value="2">管理员</ion-option>
        </ion-select>
      </ion-item>
    </ion-list>
    <div padding>
      <button *ngIf="user.role == '0'" ion-button color="primary" (tap)="signup()" block [disabled]="!signupForm.valid">注册</button>
      <button *ngIf="user.role == '1'" ion-button color="primary" (tap)="signup()" block [disabled]="!signupForm.valid">注册</button>
    </div>
  </form>
</ion-content>
